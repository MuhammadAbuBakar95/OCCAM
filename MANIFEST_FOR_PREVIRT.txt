The proposed new manifest for previrtualization:

* modules  [list of paths to bc]  [no longer use libs]

* module  single path to main bc

* binary  name for binary

* libs   (bc)  [DEPRECATED]

* name  (huh?)

* native libs [either paths to .o .a .so or flags like -lm -lc -lpthread]

* ldflags [linker flags like '--static' '--nostdlib' as well as '-L..' flags to indicate where the native libs are]

* search  [DEPRECATED  use -L...  in ldflags if you MUST ]

* shared  [DEPRECATED]

* arguments [list of specialized args to main ]

* watch [ an examples would be nice ]

So for example: musl_nweb would look like:



{ "module"      :  "nweb.o.bc"
, "binary"      : "nweb_occam"
, "modules"     : ["libc.a.bc"]
, "native_libs" : ["crt1.o", "libc.a"]
, "ldflags"     : [ "--static", "-nostdlib" ]
, "args"        : ["8181", "${ROOT}"]
, "name"        : "nweb"
}


while yices would look like


{ "module"      : "yices_smt2.bc"
, "binary"      : "yices_smt2_previrt"
, "modules"     : ["libpoly.so.bc"]
, "native-libs" : ["-lgmp"]
, "ldflags"     : ["-L/usr/lib", "-L/usr/local/lib", "-L/usr/lib/x86_64-linux-gnu/"]
, "name"        : "yices_smt2"
}


or

{ "module"      :  "yices_smt2.bc"
, "binary"      : "yices_smt2_gmp"
, "modules"     : ["libpoly.so.bc", "libgmp.so.bc"]
, "native-libs" : []
, "ldflags"     : []
, "name"        : "yices_smt2_gmp"
}

or

{ "module"      :  "yices_smt2.bc"
, "binary"      : "yices_smt2_gmp_c"
, "modules"     : ["libpoly.so.bc", "libgmp.so.bc", "libc.a.bc"]
, "native-libs" : ["crt1.o", "libc.a"]
, "ldflags"     : [ "--static", "-nostdlib" ]
, "name"        : "yices_smt2_gmp"
}


note that bc paths are either absolute or relative to the current working directory.
whereas native libs are either absolute or relative to the current working directory
or in the search path indicated by the ldflags.

